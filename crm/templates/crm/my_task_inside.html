{% extends "crm/base.html" %}

{% block style %}
<!--    style for comments  -->
    body {
        margin: 0 auto;
        max-width: 800px;
        padding: 0 20px;
    }

    .container {
        border: 2px solid #dedede;
        background-color: #f1f1f1;
        border-radius: 10px;
        padding: 10px;
        margin: 10px 0;
    }

    .darker {
        border-color: #ccc;
        background-color: #ddd;
    }

    .container::after {
        content: "";
        clear: both;
        display: table;
    }

    .time-right {
        float: right;
        color: #aaa;
    }


{% endblock %}


{% block body %}
    <h1>{{ task.subject }}</h1>
    <div>
        <p>{{ task.final_date }}</p>
<!--        <p><pre>{{ task.description }}</pre></p>-->
        <p>{{ task.description|linebreaks }}</p>
    </div>

<!--    check-box completed     -->
    <div>
        <form method="POST">
        {% csrf_token %}
            <p>
                Completed: <input type="checkbox" id="myCheck" name="status" onclick="completeActivate()" >
            </p>
            <input disabled name="complete" type="submit" value="Завершить">
        </form>
    </div>

<!--    check-box delegation    -->
    <div>
        <form method="POST">
            {% csrf_token %}
            <p>
                Not my task: <input type="checkbox" id="notMyTask" name="notMyTask" onclick="delegateActivate()">
            </p>
            <select disabled id="profile" name="profile">
                {% for profile in profiles %}
                    <option value="{{ profile.id }}">{{ profile.name }} {{ profile.surname }}</option>
                {% endfor %}
            </select>
            <input disabled name="delegate" type="submit" value="Перенаправить">
        </form>
    </div>


<!--    create Comment    -->
    <br>
    <div id="create_comment">
        <form method="POST">
            {% csrf_token %}
            <p>create a comment:</p>
            {{ comment_form.text }}
            <br>
            <input name="sent_comment" type="submit" value="отправить коментарий">

        </form>
    </div>

<!--   output Comments    -->
    <br>
    <div id="block_comment">
<!--        <h2>Comment</h2>-->
        {% for comment in comments %}
            <div class="container">
                <h4>{{ comment.author.name }} {{ comment.author.surname }}</h4>
                <p>{{ comment.text|linebreaks }}</p>
                <span class="time-right">{{ comment.date }}</span>
            </div>
        {% endfor %}
    </div>


    <script>
        function completeActivate() {
            var complete = document.getElementsByName('complete')[0];
            if (document.getElementById('myCheck').checked) {
<!--                console.log(complete)-->
                complete.disabled = '';
            } else {
                complete.disabled = 'disabled';
            }
        }

        function delegateActivate() {
            var profile = document.getElementsByName('profile')[0];
            var delegate = document.getElementsByName('delegate')[0];
            if (document.getElementById('notMyTask').checked) {
<!--                console.log(delegate)-->
<!--                console.log(profile)-->
                profile.disabled = '';
                delegate.disabled = '';
            } else {
                profile.disabled = 'disabled';
                delegate.disabled = 'disabled';
            }
        }
    </script>
{% endblock %}
